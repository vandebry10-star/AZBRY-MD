name: Flatten extracted/AZBRY-MD to root

on:
  workflow_dispatch:
  push:
    paths:
      - 'extracted/**'

jobs:
  flatten:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Move contents to repo root
        run: |
          set -e
          if [ -d "extracted/AZBRY-MD" ]; then
            echo "üì¶ Found extracted/AZBRY-MD ‚Äî moving its contents to repo root‚Ä¶"
            shopt -s dotglob nullglob
            mv extracted/AZBRY-MD/* .
            # If there are nested folders inside, they were moved above.
            # Clean up the empty parent directories:
            rm -rf extracted/AZBRY-MD
            rmdir -p extracted 2>/dev/null || true
            echo "‚úÖ Move completed."
          else
            echo "‚ö†Ô∏è Folder extracted/AZBRY-MD not found. Nothing to do."
          fi

      - name: Commit & push
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "actions@github.com"
          git add -A
          git commit -m "chore: move extracted/AZBRY-MD contents to repo root" || echo "No changes to commit."
          git push
